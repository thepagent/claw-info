# OpenClaw v2026.2.21 Release Notes (2026-02-21)

[GitHub Release](https://github.com/openclaw/openclaw/releases/tag/v2026.2.21)

> Note: npm 後續發佈了修正版 `openclaw@2026.2.21-1`。

## 概述

### 功能更新 (Features)

- ⭐⭐⭐ 新增 Volcano Engine（Doubao）與 BytePlus provider/model，並完善 onboarding 流程（[#7967](https://github.com/openclaw/openclaw/pull/7967)）
- ⭐⭐⭐ Discord：支援 thread-bound subagent sessions（thread 綁定的子代理）（[#21805](https://github.com/openclaw/openclaw/pull/21805)）
- ⭐⭐⭐ Channels/CLI：新增 per-account/channel `defaultTo` 路由 fallback（[#16985](https://github.com/openclaw/openclaw/pull/16985)）
- ⭐⭐ Models/Google：新增 Gemini 3.1 支援（`google/gemini-3.1-pro-preview`）
- ⭐⭐ Channels：支援 per-channel model overrides（`channels.modelByChannel`）
- ⭐⭐ Telegram：簡化 streaming 預覽設定與相容舊 `streamMode`（[#22012](https://github.com/openclaw/openclaw/pull/22012)）
- ⭐⭐ Discord：新增 stream preview mode（live draft replies）
- ⭐⭐ Discord/Telegram：新增可設定的 lifecycle status reactions（queued/thinking/tool/done/error）
- ⭐⭐ Discord：新增 voice channel 支援（`/vc` join/leave/status + auto-join）
- ⭐⭐ Discord：可設定 slash-command 回覆 ephemeral 預設值（[#16563](https://github.com/openclaw/openclaw/pull/16563)）
- ⭐⭐ Discord：支援更新 forum channel 的 `available_tags`（[#12070](https://github.com/openclaw/openclaw/pull/12070)）
- ⭐⭐ iOS/Chat：清理 UI 雜訊並強化輸入/顯示（[#22122](https://github.com/openclaw/openclaw/pull/22122)）
- ⭐⭐ iOS/Watch：將 watch prompt actions 轉接到 iOS quick-reply（[#22123](https://github.com/openclaw/openclaw/pull/22123)）
- ⭐⭐ iOS/Gateway：穩定背景喚醒與重連行為（[#21226](https://github.com/openclaw/openclaw/pull/21226)）
- ⭐⭐ Auto-reply/UI：增加 model fallback 的可視性與 /status 背景資訊（[#20704](https://github.com/openclaw/openclaw/pull/20704)）
- ⭐ Discord：在 trusted inbound metadata 中包含 channel topics
- ⭐ MSTeams：去重 sent-message cache 儲存（[#22514](https://github.com/openclaw/openclaw/pull/22514)）
- ⭐ Agents/Subagents：調整預設 spawn depth 的一致性（[#22223](https://github.com/openclaw/openclaw/pull/22223)）
- ⭐ Dependencies/Tooling：CI 新增 dead-code scans（Knip/ts-prune/ts-unused-exports）（[#22468](https://github.com/openclaw/openclaw/pull/22468)）
- ⭐ Dependencies：移除未使用的 root/extension deps（[#22471](https://github.com/openclaw/openclaw/pull/22471)、[#22495](https://github.com/openclaw/openclaw/pull/22495)）
- ⭐ Dependencies/A2UI：強化 dependency resolution 與 bundling fallback（[#22481](https://github.com/openclaw/openclaw/pull/22481)、[#22507](https://github.com/openclaw/openclaw/pull/22507)）

### 安全性提升 (Security)

- ⭐⭐⭐ Gateway lock 與 tool-call synthetic IDs：雜湊基礎由 SHA-1 改為 SHA-256（[#7343](https://github.com/openclaw/openclaw/issues/7343)）
- ⭐⭐⭐ Owner-ID obfuscation 改用專用 HMAC secret（[#7343](https://github.com/openclaw/openclaw/issues/7343)）
- ⭐⭐⭐ Exec：阻擋 heredoc body expansion tokens 的 allowlist bypass
- ⭐⭐⭐ macOS：阻擋 `rawCommand` chaining 的 `system.run` allowlist bypass
- ⭐⭐⭐ Gateway hooks：阻擋 `__proto__`/`constructor`/`prototype` traversal（[#22213](https://github.com/openclaw/openclaw/pull/22213)）
- ⭐⭐⭐ Browser：阻擋 upload path 的 symlink escape（[#21972](https://github.com/openclaw/openclaw/pull/21972)）
- ⭐⭐⭐ Browser：阻擋 `file:`/`data:`/`javascript:` 導航協定
- ⭐⭐⭐ Exec：阻擋 shell startup-file env injection（`BASH_ENV`、`LD_*`、`DYLD_*`）
- ⭐⭐⭐ ACP：對 `resource_link` metadata 進行跳脫，降低 prompt injection 風險（[#19009](https://github.com/openclaw/openclaw/pull/19009)）
- ⭐⭐⭐ Net：跨 origin redirect 時剝離敏感 header（[#20313](https://github.com/openclaw/openclaw/pull/20313)）
- ⭐⭐⭐ Gateway/Pairing：阻止 device-token rotate scope escalation（[#20703](https://github.com/openclaw/openclaw/pull/20703)）
- ⭐⭐⭐ WhatsApp：強制 allowlist JID 授權於 reaction actions
- ⭐⭐⭐ Agents：限制 local MEDIA tool attachments 至 core tools 與 temp root
- ⭐⭐⭐ Sandbox Browser：多項加固（VNC auth、dedicated network、no-sandbox opt-in）
- ⭐⭐ Gateway/Security：Control UI auth hardened 行為對齊（[#20684](https://github.com/openclaw/openclaw/pull/20684)）
- ⭐⭐ Shared/Security：拒絕非 loopback 的不安全 `ws://` deep links（[#21970](https://github.com/openclaw/openclaw/pull/21970)）
- ⭐⭐ OpenClawKit/UI：避免 inbound metadata blocks 泄漏至 UI（[#22142](https://github.com/openclaw/openclaw/pull/22142)、[#22345](https://github.com/openclaw/openclaw/pull/22345)、[#22346](https://github.com/openclaw/openclaw/pull/22346)）
- ⭐⭐ TTS：model-driven provider switching 改為 opt-in
- ⭐⭐ Skills：sanitize skill env overrides 阻擋 runtime injection
- ⭐⭐ Commands：阻擋 `/debug` overrides 的 prototype-key injection
- ⭐⭐ Systemd：拒絕 CR/LF 於 unit environment values
- ⭐ Gateway：`X-Forwarded-For` trust-preserving 解析（防 proxy-chain spoofing）
- ⭐ Dependencies：bump `hono` 至 4.11.10（timing-safe auth，`GHSA-gq3j-xvxp-8hrf`）
- ⭐ Docker：E2E/install-sh test images 改為 non-root

### 錯誤修復 (Bug Fixes)

- ⭐⭐⭐ Agents：cap embedded Pi runner retry loop，防止無限重試（`GHSA-76m6-pj3w-v7mf`）
- ⭐⭐⭐ Memory/QMD：大量修復（搜尋分割、boot retry、BM25 skip、embed 序列化等）（[#20581](https://github.com/openclaw/openclaw/issues/20581) 等 8 個 issue）
- ⭐⭐⭐ Agents/Compaction：修復 production 中 compaction safeguard 載入（[#22349](https://github.com/openclaw/openclaw/pull/22349)）
- ⭐⭐ Models/Kimi-Coding：補齊 implicit provider template，修復 403（[#22409](https://github.com/openclaw/openclaw/issues/22409)）
- ⭐⭐ Providers/Copilot：移除 Claude persisted `thinking` blocks（[#19459](https://github.com/openclaw/openclaw/pull/19459)）
- ⭐⭐ Providers/Copilot：新增 `claude-sonnet-4.6`/`claude-sonnet-4.5` 至 Copilot model catalog（[#20270](https://github.com/openclaw/openclaw/pull/20270)）
- ⭐⭐ Telegram：偵測 duplicate bot-token ownership，避免 `getUpdates` 衝突迴圈
- ⭐⭐ Slack：修復 native streaming 的 `recipient_team_id`/`recipient_user_id` 傳遞（[#20988](https://github.com/openclaw/openclaw/pull/20988)）
- ⭐⭐ Memory/Builtin：防止 sync race with manager shutdown（[#20556](https://github.com/openclaw/openclaw/issues/20556)、[#7464](https://github.com/openclaw/openclaw/issues/7464)）
- ⭐⭐ Auto-reply/Tools：傳遞 `senderIsOwner` 參數（[#22296](https://github.com/openclaw/openclaw/pull/22296)）
- ⭐⭐ Gateway/Pairing：多項修復（token mismatch、legacy metadata、scope alignment）
- ⭐⭐ Cron：修復 `maxConcurrentRuns` 未生效（[#11595](https://github.com/openclaw/openclaw/issues/11595)）
- ⭐⭐ TUI/History：修復大量歷史載入時 `RangeError: Maximum call stack size exceeded`（[#18068](https://github.com/openclaw/openclaw/issues/18068)）
- ⭐ Discord：修復 model picker 缺 provider 時的返回導航（[#21458](https://github.com/openclaw/openclaw/pull/21458)）
- ⭐ Telegram/Streaming：多項修復（draft cleanup、reasoning/answer lane split、debounce）
- ⭐ TUI/Input：抑制重複 backspace 事件（[#19318](https://github.com/openclaw/openclaw/issues/19318)）
- ⭐ Docker/Build：修復 `TS2769` 與 Playwright Chromium 安裝（[#22558](https://github.com/openclaw/openclaw/pull/22558)、[#22585](https://github.com/openclaw/openclaw/pull/22585)）

---

## 功能更新 (Features) - by Star Rating

### ⭐⭐⭐ Providers/Onboarding：新增 Volcano Engine（Doubao）與 BytePlus provider/model（[#7967](https://github.com/openclaw/openclaw/pull/7967)）
- **用途**：支援新的雲端 LLM 供應商與模型（含 coding variants），並在 onboarding 提供互動/非互動認證選項。
- **解決問題**：降低新增 provider 的整合成本，讓使用者可更快完成設定。
- **影響**：擴充可用模型版圖，提升部署彈性與可選擇性。

### ⭐⭐⭐ Channels/CLI：新增 per-account/channel `defaultTo` 路由 fallback（[#16985](https://github.com/openclaw/openclaw/pull/16985)）
- **用途**：讓 `openclaw agent --deliver` 在未指定 `--reply-to` 時，能依預設目標投遞。
- **解決問題**：避免因缺少目標參數導致投遞失敗或需手動補參。
- **影響**：提升 CLI 自動化/排程投遞的穩定性。

### ⭐⭐⭐ Discord/Subagents：支援 thread-bound subagent sessions（[#21805](https://github.com/openclaw/openclaw/pull/21805)）
- **用途**：在 Discord thread 內生成並綁定 subagent session，提供 per-thread focus/list 控制與路由延續。
- **解決問題**：降低跨 thread/跨 session 的脈絡混淆，避免子任務回覆跑錯地方。
- **影響**：強化 Discord 上的多任務協作體驗。

### ⭐⭐ Models/Google：新增 Gemini 3.1 支援
- **用途**：新增 `google/gemini-3.1-pro-preview` 模型支援。
- **解決問題**：讓使用者可使用最新的 Google Gemini 模型。
- **影響**：擴充可用模型選擇。

### ⭐⭐ Channels：支援 per-channel model overrides
- **用途**：透過 `channels.modelByChannel` 設定不同 channel 使用不同模型，並在 /status 顯示。
- **解決問題**：避免所有 channel 被迫使用同一模型。
- **影響**：提升多 channel 部署的彈性。

### ⭐⭐ Telegram/Streaming：簡化 streaming 預覽設定並相容舊值（[#22012](https://github.com/openclaw/openclaw/pull/22012)）
- **用途**：以 `channels.telegram.streaming` 布林值簡化設定，並自動對映 legacy `streamMode`。
- **解決問題**：減少設定分歧與相容性困擾。
- **影響**：降低升級成本，提升 streaming 行為一致性。

### ⭐⭐ Discord/Streaming：新增 stream preview mode
- **用途**：支援 live draft replies，提供 partial/block 選項與可設定的 chunking。
- **解決問題**：讓使用者在等待完整回覆前就能看到進度。
- **影響**：提升 Discord 互動的即時感。

### ⭐⭐ Discord/Telegram：新增可設定的 lifecycle status reactions
- **用途**：為 queued/thinking/tool/done/error 各階段提供 emoji/timing overrides 的 shared controller。
- **解決問題**：讓使用者直觀了解 agent 目前的處理狀態。
- **影響**：提升互動可觀測性與使用者體驗。

### ⭐⭐ Discord/Voice：新增 voice channel 支援
- **用途**：透過 `/vc` 指令 join/leave/status，加上 auto-join 設定支援 realtime voice conversations。
- **解決問題**：讓 agent 可參與 Discord 語音頻道互動。
- **影響**：開啟語音互動場景。

### ⭐⭐ Discord：可設定 slash-command 回覆 ephemeral 預設值（[#16563](https://github.com/openclaw/openclaw/pull/16563)）
- **用途**：針對 Discord slash command 回覆提供可配置的 ephemeral 預設。
- **解決問題**：避免每次回覆都需手動選擇是否公開/隱藏。
- **影響**：改善管理與互動體驗，降低誤發公開訊息的機率。

### ⭐⭐ Discord：支援更新 forum channel 的 `available_tags`（[#12070](https://github.com/openclaw/openclaw/pull/12070)）
- **用途**：透過 channel edit actions 管理 forum tags。
- **解決問題**：減少需手動進入 Discord UI 調整 tag 的成本。
- **影響**：提升社群/討論區治理效率。

### ⭐⭐ iOS/Chat：清理 UI 雜訊並強化輸入/顯示（[#22122](https://github.com/openclaw/openclaw/pull/22122)）
- **用途**：去除 inbound untrusted metadata/timestamp 前綴、精簡 tool outputs 呈現、輸入時 compact composer、支援點擊收起鍵盤。
- **解決問題**：改善閱讀性與輸入體驗，降低 chat 內容被雜訊淹沒。
- **影響**：提升 iOS 客戶端可用性與日常互動效率。

### ⭐⭐ iOS/Watch：將 watch prompt actions 轉接到 iOS quick-reply（[#22123](https://github.com/openclaw/openclaw/pull/22123)）
- **用途**：支援 watch 端通知操作轉接與 queued action handoff。
- **解決問題**：避免 watch 操作與 iOS app 初始化不同步造成的回覆失敗。
- **影響**：提升穿戴裝置互動可靠度。

### ⭐⭐ iOS/Gateway：穩定背景喚醒與重連行為（[#21226](https://github.com/openclaw/openclaw/pull/21226)）
- **用途**：加入 background reconnect suppression/lease windows、BGAppRefresh wake fallback、location wake hook throttling、APNs wake retry+nudge instrumentation。
- **解決問題**：減少 iOS 背景斷線與重連不穩定。
- **影響**：提升 iOS 客戶端的背景可靠度。

### ⭐⭐ Auto-reply/UI：增加 model fallback 的可視性與 /status 背景資訊（[#20704](https://github.com/openclaw/openclaw/pull/20704)）
- **用途**：在 verbose logs 與 /status 顯示 active-model 與 fallback reason。
- **解決問題**：排查「為何不是用預期模型」的疑難更容易。
- **影響**：提升可觀測性與除錯效率。

### ⭐ Discord：在 trusted inbound metadata 中包含 channel topics
- **用途**：新 session 時將 channel topic 納入 trusted metadata。
- **解決問題**：讓 agent 可感知 channel 主題脈絡。
- **影響**：提升 context-aware 回覆品質。

### ⭐ MSTeams：去重 sent-message cache 儲存（[#22514](https://github.com/openclaw/openclaw/pull/22514)）
- **用途**：移除重複的 per-message Set storage，改用 timestamps Map keys。
- **解決問題**：減少不必要的儲存開銷。
- **影響**：提升 MSTeams channel 效率。

### ⭐ Agents/Subagents：調整預設 spawn depth 的一致性（[#22223](https://github.com/openclaw/openclaw/pull/22223)）
- **用途**：預設 `maxSpawnDepth=2`，使 depth-1 orchestrator spawning 預設可用。
- **解決問題**：減少 spawn depth 規則不一致導致的行為落差。
- **影響**：讓子代理編排更穩定可預期。

### ⭐ Dependencies/Tooling：CI 新增 dead-code scans（[#22468](https://github.com/openclaw/openclaw/pull/22468)）
- **用途**：透過 Knip/ts-prune/ts-unused-exports 在 CI 中非阻塞地掃描未使用的 dependencies 與 exports。
- **解決問題**：更早發現 dead code。
- **影響**：提升 codebase 健康度。

### ⭐ Dependencies：移除未使用的 root/extension deps（[#22471](https://github.com/openclaw/openclaw/pull/22471)、[#22495](https://github.com/openclaw/openclaw/pull/22495)）
- **用途**：移除 `@larksuiteoapi/node-sdk`、`signal-utils`、`ollama`、`lit` 等未使用的 deps。
- **解決問題**：減少安裝體積與潛在供應鏈風險。
- **影響**：精簡 dependency tree。

### ⭐ Dependencies/A2UI：強化 dependency resolution（[#22481](https://github.com/openclaw/openclaw/pull/22481)、[#22507](https://github.com/openclaw/openclaw/pull/22507)）
- **用途**：修復 root cleanup 後的 `lit`/`@lit/context` 等解析，簡化 bundling fallback（含 `pnpm dlx rolldown` 相容）。
- **解決問題**：避免 dependency resolution 失敗。
- **影響**：提升建置穩定性。

---

## 安全性提升 (Security) - by Star Rating

### ⭐⭐⭐ Security/Agents：owner-ID obfuscation 改用專用 HMAC secret（[#7343](https://github.com/openclaw/openclaw/issues/7343)）
- **用途**：以 `ownerDisplaySecret` 控制 owner 顯示混淆。
- **解決問題**：將 owner obfuscation 與 gateway token handling 解耦，降低誤用/耦合風險。
- **影響**：提升識別資訊處理的可控性與一致性。

### ⭐⭐⭐ Security/Infra：gateway lock 與 synthetic IDs 的雜湊基礎改為 SHA-256（[#7343](https://github.com/openclaw/openclaw/issues/7343)）
- **用途**：以 SHA-256 取代 SHA-1（保持截斷長度與 deterministic 行為）。
- **解決問題**：強化雜湊基礎，降低 SHA-1 相關風險。
- **影響**：提升整體基礎設施安全性。

### ⭐⭐⭐ Security/Exec：阻擋 heredoc body expansion tokens 的 allowlist bypass
- **用途**：在 shell allowlist 分析中阻擋 unquoted heredoc body expansion tokens，拒絕未終止的 heredocs，並要求 gateway host 上的 allowlisted heredoc 執行需明確核准。
- **解決問題**：防止透過 heredoc substitution 繞過 allowlist。
- **影響**：強化 shell 執行安全邊界。

### ⭐⭐⭐ macOS/Security：阻擋 `system.run` allowlist bypass via `rawCommand` chaining
- **用途**：在 macOS node runtime 與 companion exec host 中，對每個 shell segment 評估 `system.run` allowlists（含 chained shell operators），對 shell/process substitution 解析失敗時 fail closed。
- **解決問題**：防止透過 `rawCommand` chaining 繞過 allowlist。
- **影響**：強化 macOS 執行安全。

### ⭐⭐⭐ Security/Exec：阻擋 shell startup-file env injection
- **用途**：在 config env ingestion、node-host inherited environment sanitization、macOS exec host runtime 中阻擋 `BASH_ENV`、`ENV`、`BASH_FUNC_*`、`LD_*`、`DYLD_*`。
- **解決問題**：防止攻擊者透過環境變數在指令前執行惡意程式碼。
- **影響**：消除 pre-command execution 攻擊向量。

```text
        ┌──────────────┐
        │ 使用者指令輸入 │
        └──────┬───────┘
               ▼
        ┌──────────────┐    ✗ BASH_ENV/LD_*/DYLD_*
        │ 環境變數過濾  │───► 阻擋 startup-file injection
        └──────┬───────┘
               ▼
        ┌──────────────┐    ✗ unquoted heredoc expansion
        │ Heredoc 檢查  │───► 阻擋未終止/未引用的 heredoc
        └──────┬───────┘
               ▼
        ┌──────────────┐    ✗ cmd1 && cmd2 chaining
        │ Per-segment   │───► 每段 shell operator 獨立評估
        │ Allowlist 評估│
        └──────┬───────┘
               ▼
        ┌──────────────┐
        │ 明確核准後執行 │
        └──────────────┘
```

### ⭐⭐⭐ Security/Exec (Windows)：canonicalize `cmd.exe /c` command text
- **用途**：統一 validation、approval binding、audit/event rendering 中的 `cmd.exe /c` command text。
- **解決問題**：防止 trailing-argument approval mismatches。
- **影響**：強化 Windows 平台的 `system.run` 安全。

### ⭐⭐⭐ Security/Browser：阻擋非網路導航協定
- **用途**：阻擋 `file:`、`data:`、`javascript:` 等協定（保留 `about:blank`）。
- **解決問題**：防止透過 browser tool navigation 讀取本地檔案。
- **影響**：強化 browser 工具的導航安全邊界。

### ⭐⭐⭐ Security/Browser：阻擋 upload path symlink escapes（[#21972](https://github.com/openclaw/openclaw/pull/21972)）
- **用途**：避免 browser upload 來源透過 symlink 逃逸至允許範圍外。
- **解決問題**：降低被利用讀取不該讀取檔案的風險。
- **影響**：強化 browser 工具的本地檔案邊界。

### ⭐⭐⭐ Security/Gateway/Hooks：阻擋 prototype-chain traversal（[#22213](https://github.com/openclaw/openclaw/pull/22213)）
- **用途**：在 webhook template path resolution 中阻擋 `__proto__`/`constructor`/`prototype`。
- **解決問題**：避免原型鏈資料外洩或異常解析。
- **影響**：降低 webhook 相關攻擊面。

### ⭐⭐⭐ Security/ACP：escape `resource_link` metadata（[#19009](https://github.com/openclaw/openclaw/pull/19009)）
- **用途**：在 prompt interpolation 前對 ACP `resource_link` title/URI metadata 中的控制字元與分隔符進行跳脫。
- **解決問題**：防止透過 resource links 進行 metadata-driven prompt injection。
- **影響**：強化 ACP 安全邊界。

### ⭐⭐⭐ Security/Net：跨 origin redirect 時剝離敏感 header（[#20313](https://github.com/openclaw/openclaw/pull/20313)）
- **用途**：在 `fetchWithSsrFGuard` 的 cross-origin redirects 移除 `Authorization`、`Proxy-Authorization`、`Cookie`、`Cookie2` header。
- **解決問題**：避免憑證被轉送到非預期 origin。
- **影響**：降低 SSRF/redirect 造成的憑證外洩風險。

### ⭐⭐⭐ WhatsApp/Security：強制 allowlist JID 授權於 reaction actions
- **用途**：對 reaction actions 強制 allowlist JID 授權。
- **解決問題**：防止 authenticated callers 透過偽造 `chatJid` + valid `messageId` 對非 allowlisted chats 操作。
- **影響**：強化 WhatsApp channel 的存取控制。

### ⭐⭐⭐ Security/Agents：限制 local MEDIA tool attachments
- **用途**：限制 local MEDIA tool attachments 至 core tools 與 OpenClaw temp root。
- **解決問題**：防止 untrusted MCP tool 進行檔案外洩。
- **影響**：強化 tool 檔案存取邊界。

### ⭐⭐⭐ Security/Agents：cap overflow compaction retry budgeting
- **用途**：保持 overflow compaction retry budgeting 為全域計數。
- **解決問題**：防止成功的 truncation 重置 overflow retry counter，造成 retry/cost 放大。
- **影響**：降低異常成本風險。

### ⭐⭐⭐ Gateway/Pairing：阻止 device-token rotate scope escalation（[#20703](https://github.com/openclaw/openclaw/pull/20703)）
- **用途**：強制 approved-scope baseline，跨 metadata updates 保留 approved scopes，拒絕超出 approved role scope 的 rotate requests。
- **解決問題**：防止 scope escalation。
- **影響**：強化裝置配對安全。

### ⭐⭐⭐ BlueBubbles/Security：要求 webhook token authentication
- **用途**：對所有 BlueBubbles webhook requests（含 loopback/proxied）要求 token authentication。
- **解決問題**：移除 passwordless webhook fallback。
- **影響**：強化 BlueBubbles channel 安全。

### ⭐⭐⭐ Sandbox Browser：多項加固
- **用途**：移除預設 `--no-sandbox`（改為 opt-in `OPENCLAW_BROWSER_NO_SANDBOX`）、要求 noVNC password auth、預設使用 dedicated Docker network（`openclaw-sandbox-browser`）、新增 CDP ingress source-range 限制。
- **解決問題**：降低 sandbox browser 的攻擊面。
- **影響**：大幅提升 browser sandbox 安全基線。

```text
        ┌───────────────────┐
        │ Browser Container  │
        └────────┬──────────┘
                 │
    ┌────────────┼────────────┐
    ▼            ▼            ▼
┌────────┐ ┌──────────┐ ┌──────────┐
│Chromium│ │ noVNC    │ │ CDP 端口  │
│sandbox │ │ 密碼認證  │ │ 來源限制  │
│(opt-in │ │ (短效    │ │ (ingress │
│ 關閉)  │ │  token)  │ │  range)  │
└────────┘ └──────────┘ └──────────┘
                 │
                 ▼
        ┌───────────────────┐
        │ 專用 Docker 網路   │
        │(openclaw-sandbox- │
        │  browser)         │
        └───────────────────┘
```

### ⭐⭐ Gateway/Security：Control UI auth hardened 行為對齊（[#20684](https://github.com/openclaw/openclaw/pull/20684)）
- **用途**：即使設定 `gateway.controlUi.allowInsecureAuth`，仍要求 secure context 與 paired-device checks。
- **解決問題**：避免錯誤設定導致不安全的 control UI auth 行為。
- **影響**：提升 control UI 的預設安全基線。

### ⭐⭐ Gateway/Security：scope tokenless Tailscale auth 至 Control UI websocket only
- **用途**：限制 Tailscale forwarded-header auth 僅適用於 Control UI websocket auth。
- **解決問題**：確保 HTTP gateway routes 仍需 token/password。
- **影響**：縮小 tokenless auth 的適用範圍。

### ⭐⭐ Gateway/Security：移除 canvas endpoints 的 shared-IP fallback
- **用途**：要求 token 或 session capability 才能存取 canvas。
- **解決問題**：防止 shared-IP 環境下的未授權存取。
- **影響**：強化 canvas 存取控制。

### ⭐⭐ Shared/Security：拒絕非 loopback 的不安全 `ws://` deep links（[#21970](https://github.com/openclaw/openclaw/pull/21970)）
- **用途**：防止使用 `ws://`（非 loopback）設定遠端 gateway。
- **解決問題**：避免明文 websocket 帶來的竊聽/中間人風險。
- **影響**：提升跨裝置設定流程的傳輸安全。

### ⭐⭐ macOS/Security：拒絕非 loopback `ws://` remote gateway URLs（[#21971](https://github.com/openclaw/openclaw/pull/21971)）
- **用途**：在 macOS remote config 中阻擋不安全的 plaintext websocket endpoints。
- **解決問題**：與 shared security 一致的 macOS 端保護。
- **影響**：強化 macOS 傳輸安全。

### ⭐⭐ iOS/Security：強制 `https://` 於非 loopback manual gateway hosts（[#21969](https://github.com/openclaw/openclaw/pull/21969)）
- **用途**：在 iOS onboarding 時阻擋不安全的 remote transport URLs。
- **解決問題**：防止使用者設定不安全的遠端連線。
- **影響**：強化 iOS 傳輸安全。

### ⭐⭐ Security/OpenClawKit/UI：防止 inbound metadata blocks 泄漏至 UI（[#22142](https://github.com/openclaw/openclaw/pull/22142)、[#22345](https://github.com/openclaw/openclaw/pull/22345)、[#22346](https://github.com/openclaw/openclaw/pull/22346)）
- **用途**：在 TUI/webchat/macOS 顯示邊界剝離 untrusted metadata 前綴，修正 streaming 情境下的 reply-tag artifacts。
- **解決問題**：避免使用者訊息被注入偽造 metadata 造成誤導。
- **影響**：提升前端顯示安全與一致性。

### ⭐⭐ Security/Tools：untrusted-content markers 加入 per-wrapper random IDs（[#19009](https://github.com/openclaw/openclaw/pull/19009)）
- **用途**：防止 marker spoofing 逃逸 content boundaries。
- **解決問題**：強化 `wrapExternalContent`/`wrapWebContent` 的邊界完整性。
- **影響**：降低 content injection 風險。

### ⭐⭐ TTS/Security：model-driven provider switching 改為 opt-in
- **用途**：預設 `messages.tts.modelOverrides.allowProvider=false`，保留 voice/style overrides。
- **解決問題**：降低 prompt-injection-driven provider hops 與非預期 TTS 成本。
- **影響**：提升 TTS 安全預設。

### ⭐⭐ Skills/Security：sanitize skill env overrides
- **用途**：阻擋 unsafe runtime injection variables，僅允許 skill metadata 中宣告的 sensitive keys。
- **解決問題**：防止透過 skill env 進行 runtime injection。
- **影響**：強化 skills 執行安全。

### ⭐⭐ Security/Commands：阻擋 `/debug` overrides 的 prototype-key injection
- **用途**：要求 own-property checks for gated command flags（`bash`、`config`、`debug`）。
- **解決問題**：防止 inherited prototype values 啟用 privileged commands。
- **影響**：強化 runtime debug 安全。

### ⭐⭐ Security/Systemd：拒絕 CR/LF 於 unit environment values
- **用途**：修正 argument escaping，防止 generated units 被注入額外 directives。
- **解決問題**：防止 systemd unit injection。
- **影響**：強化 Linux 部署安全。

### ⭐⭐ Docker/Security：E2E/install-sh test images 改為 non-root
- **用途**：新增 appuser directives。
- **解決問題**：降低 test image 的權限風險。
- **影響**：提升 CI/CD 安全基線。

### ⭐ Security/Gateway：`X-Forwarded-For` trust-preserving 解析
- **用途**：當 requests 來自 configured trusted proxies 時，以 trust-preserving semantics 解析 `X-Forwarded-For`。
- **解決問題**：防止 proxy-chain spoofing 影響 client IP classification 與 rate-limit identity。
- **影響**：提升 rate limiting 準確度。

### ⭐ Security/Dependencies：bump `hono` 至 4.11.10
- **用途**：納入 `basicAuth`/`bearerAuth` 的 timing-safe authentication comparison hardening（`GHSA-gq3j-xvxp-8hrf`）。
- **解決問題**：降低 timing attack 風險。
- **影響**：提升 auth middleware 安全。

---

## 錯誤修復 (Bug Fixes) - by Star Rating

### ⭐⭐⭐ Security/Agents：cap embedded Pi runner retry loop（`GHSA-76m6-pj3w-v7mf`）
- **用途**：以 profile-aware dynamic limit（32-160 attempts）限制 outer retry loop，並在 retries 未收斂時回傳明確的 `retry_limit` error payload。
- **解決問題**：防止無限內部重試迴圈。
- **影響**：消除潛在的 DoS/成本放大風險。

### ⭐⭐⭐ Memory/QMD：大量修復（[#20581](https://github.com/openclaw/openclaw/issues/20581)、[#21590](https://github.com/openclaw/openclaw/issues/21590)、[#20513](https://github.com/openclaw/openclaw/issues/20513)、[#20001](https://github.com/openclaw/openclaw/issues/20001)、[#21266](https://github.com/openclaw/openclaw/issues/21266)、[#21583](https://github.com/openclaw/openclaw/issues/21583)、[#20346](https://github.com/openclaw/openclaw/issues/20346)、[#19493](https://github.com/openclaw/openclaw/issues/19493)）
- **用途**：尊重 per-agent `memorySearch.enabled=false`、將 multi-collection QMD 搜尋拆分為 per-collection queries、偏好 collection-hinted doc resolution、boot updates 的 transient lock/timeout retry、BM25-only `search` mode 跳過 `qmd embed`、全域序列化 embed runs with failure backoff。
- **解決問題**：修復 sparse-term drops、stale-hash collisions、CPU storms on multi-agent hosts 等問題。
- **影響**：大幅提升 memory 子系統穩定性。

```text
                    ┌──────────┐
                    │ 使用者查詢 │
                    └─────┬────┘
                          │
             ┌────────────┼────────────┐
             ▼            ▼            ▼
       ┌──────────┐ ┌──────────┐ ┌──────────┐
       │ BM25 搜尋 │ │ 向量搜尋  │ │ 混合搜尋  │
       │(session  │ │(memory   │ │(per-     │
       │ 對話集合) │ │ 記憶集合) │ │ collection)│
       └─────┬────┘ └─────┬────┘ └─────┬────┘
             │            │            │
             ▼            ▼            ▼
       ┌─────────────────────────────────┐
       │ 各集合獨立排序                    │
       │ (避免 sparse-term 被丟棄、       │
       │  避免 stale-hash 碰撞)          │
       └────────────────┬────────────────┘
                        │
                        ▼
       ┌─────────────────────────────────┐
       │ 多元化合併                       │
       │ (對話記錄不再擠掉持久記憶檔案)    │
       └────────────────┬────────────────┘
                        │
                        ▼
                  ┌──────────┐
                  │ 搜尋結果  │
                  └──────────┘
```

### ⭐⭐⭐ Memory/Builtin：防止 sync race with manager shutdown（[#20556](https://github.com/openclaw/openclaw/issues/20556)、[#7464](https://github.com/openclaw/openclaw/issues/7464)）
- **用途**：跳過 post-close sync starts，等待 in-flight sync 完成後再關閉 SQLite。
- **解決問題**：修復 ephemeral CLI flows 中 `database is not open` 錯誤。
- **影響**：提升 CLI 使用穩定性。

### ⭐⭐⭐ Agents/Compaction：修復 production 中 compaction safeguard 載入（[#22349](https://github.com/openclaw/openclaw/pull/22349)）
- **用途**：將 bundled extension factories 接入 resource loader，取代 runtime file-path resolution。
- **解決問題**：修復 embedded compaction safeguard/context-pruning extension 在 production 中未載入。
- **影響**：恢復 compaction 功能正常運作。

### ⭐⭐⭐ Agents/Subagents：修復 announce-chain delivery（[#22223](https://github.com/openclaw/openclaw/pull/22223)）
- **用途**：恢復 announce-chain delivery 至 agent injection，延遲 nested announce output 直到 descendant follow-up content 就緒，防止 descendant deferrals 消耗 announce retry budget。
- **解決問題**：修復 deep chains 丟失 final completions。
- **影響**：提升多層子代理編排可靠度。

### ⭐⭐ Models/Kimi-Coding：補齊 implicit provider template，修復 403（[#22409](https://github.com/openclaw/openclaw/issues/22409)）
- **用途**：加入 `kimi-coding` 正確的 provider template（`anthropic-messages` API type 與 base URL）。
- **解決問題**：修復 Kimi for Coding 使用時 403。
- **影響**：提升 Kimi-Coding 可用性。

### ⭐⭐ Providers/Copilot：移除 Claude persisted `thinking` blocks（[#19459](https://github.com/openclaw/openclaw/pull/19459)）
- **用途**：保留 turn 結構/tool blocks，但移除導致錯誤的 persisted `thinking`。
- **解決問題**：修復 follow-up request 因 `thinkingSignature` payload 無效而失敗。
- **影響**：提升 Copilot + Claude 的穩定性。

### ⭐⭐ Providers/Copilot：新增 Claude models 至 Copilot catalog（[#20270](https://github.com/openclaw/openclaw/pull/20270)，fixes [#20091](https://github.com/openclaw/openclaw/issues/20091)）
- **用途**：新增 `claude-sonnet-4.6` 與 `claude-sonnet-4.5` 至 default GitHub Copilot model catalog。
- **解決問題**：讓使用者可選用最新 Claude models。
- **影響**：擴充 Copilot 可用模型。

### ⭐⭐ Providers/OAuth：強化 Qwen 與 Chutes refresh handling
- **用途**：驗證 refresh response expiry values，當 providers 回傳空 refresh token 時保留先前的 refresh tokens。
- **解決問題**：修復 empty-token responses 導致的 auth 失敗。
- **影響**：提升 OAuth provider 穩定性。

### ⭐⭐ Telegram：偵測 duplicate bot-token ownership
- **用途**：在 startup/status 時偵測跨 Telegram accounts 的 duplicate bot-token，標記 secondary accounts 為 not configured，阻擋 duplicate account startup。
- **解決問題**：避免 endless `getUpdates` conflict loops。
- **影響**：提升 Telegram 多帳號部署穩定性。

### ⭐⭐ Auto-reply/Tools：傳遞 `senderIsOwner` 參數（[#22296](https://github.com/openclaw/openclaw/pull/22296)）
- **用途**：在 embedded queued/followup runner params 轉遞 `senderIsOwner`。
- **解決問題**：避免 owner-only tools 對授權 sender 變成不可用。
- **影響**：權限判斷更一致。

### ⭐⭐ Auto-reply/Tool results：序列化 tool-result delivery（[#21231](https://github.com/openclaw/openclaw/pull/21231)）
- **用途**：序列化 tool-result delivery 並在個別失敗後保持 delivery chain 繼續。
- **解決問題**：修復 concurrent tool outputs 的 user-visible ordering 問題。
- **影響**：提升 tool 結果顯示一致性。

### ⭐⭐ Auto-reply/Prompt caching：恢復 prefix-cache stability（[#20597](https://github.com/openclaw/openclaw/pull/20597)）
- **用途**：保持 inbound system metadata session-stable，將 per-message IDs 移至 untrusted conversation context。
- **解決問題**：修復 prefix-cache 不穩定。
- **影響**：提升 prompt caching 效率。

### ⭐⭐ Slack：修復 native streaming（[#20988](https://github.com/openclaw/openclaw/pull/20988)）
- **用途**：傳遞 `recipient_team_id`/`recipient_user_id` 至 Slack native streaming calls，並在 native streaming 啟用時停用 block streaming。
- **解決問題**：修復 DMs 與 Slack Connect 中 `chat.startStream`/`appendStream`/`stopStream` 不可靠。
- **影響**：提升 Slack streaming 穩定性。

### ⭐⭐ Cron：修復 `maxConcurrentRuns` 未生效（[#11595](https://github.com/openclaw/openclaw/issues/11595)）
- **用途**：在 timer loop 中尊重 `cron.maxConcurrentRuns`。
- **解決問題**：修復 due jobs 總是 serially 執行。
- **影響**：提升排程任務並行能力。

### ⭐⭐ TUI/History：修復大量歷史載入時 stack overflow（[#18068](https://github.com/openclaw/openclaw/issues/18068)）
- **用途**：限制 chat-log component growth 並 prune stale render nodes/references。
- **解決問題**：修復 `RangeError: Maximum call stack size exceeded`。
- **影響**：提升 TUI 穩定性。

### ⭐⭐ Gateway/Pairing：多項修復
- 清除 `device token mismatch`（1008）時的 persisted paired-device state（[#22071](https://github.com/openclaw/openclaw/pull/22071)）
- 容忍 legacy paired devices 缺少 `roles`/`scopes` metadata（[#21447](https://github.com/openclaw/openclaw/pull/21447)，fixes [#21236](https://github.com/openclaw/openclaw/issues/21236)）
- 對齊 read-scope compatibility 並新增 local `openclaw devices` fallback recovery（[#21616](https://github.com/openclaw/openclaw/pull/21616)）
- **影響**：提升裝置配對流程穩定性與復原能力。

### ⭐⭐ Gateway/Auth：多項修復
- 要求 `gateway.trustedProxies` 包含 loopback proxy address（[#22082](https://github.com/openclaw/openclaw/pull/22082)）
- 允許 trusted-proxy mode with loopback bind（[#20097](https://github.com/openclaw/openclaw/pull/20097)）
- 允許 authenticated clients 呼叫 `health`（[#19699](https://github.com/openclaw/openclaw/pull/19699)）
- **影響**：提升 gateway auth 設定彈性與正確性。

### ⭐⭐ Gateway/Config：允許 `gateway.customBindHost`（[#20318](https://github.com/openclaw/openclaw/pull/20318)，fixes [#20289](https://github.com/openclaw/openclaw/issues/20289)）
- **用途**：在 strict config validation 中允許 `gateway.customBindHost` when `gateway.bind="custom"`。
- **解決問題**：修復 valid custom bind-host configurations 啟動失敗。
- **影響**：提升自訂部署彈性。

### ⭐⭐ Memory/QMD：diversify mixed-source search ranking（[#19913](https://github.com/openclaw/openclaw/issues/19913)）
- **用途**：當 session 與 memory collections 同時存在時，多元化 mixed-source search ranking。
- **解決問題**：修復 session transcript hits 擠掉 durable memory-file matches。
- **影響**：提升 memory search 結果品質。

### ⭐⭐ Memory/Tools：回傳明確的 `unavailable` warnings（[#21894](https://github.com/openclaw/openclaw/issues/21894)）
- **用途**：當 embedding/provider failures 發生時（含 quota exhaustion），從 `memory_search` 回傳明確的 `unavailable` warnings/actions。
- **解決問題**：避免 disabled memory 看起來像空的 recall result。
- **影響**：提升 memory 狀態可觀測性。

### ⭐⭐ Session/Startup：修復 `/new` 與 `/reset` greeting path（[#22338](https://github.com/openclaw/openclaw/issues/22338)）
- **用途**：要求 greeting path 在回覆前先執行 Session Startup file-reading instructions。
- **解決問題**：修復 fresh-session greetings 跳過 daily memory startup context。
- **影響**：提升 session 初始化完整性。

### ⭐⭐ Auth/Onboarding：對齊 OAuth profile-id config mapping（[#12692](https://github.com/openclaw/openclaw/pull/12692)）
- **用途**：對齊 OpenAI Codex 與 Chutes flows 的 OAuth profile-id config mapping 與 stored credential IDs。
- **解決問題**：修復 `provider:default` mismatches。
- **影響**：提升 OAuth onboarding 穩定性。

### ⭐⭐ Provider/HTTP：HTTP 503 視為 failover-eligible（[#21086](https://github.com/openclaw/openclaw/pull/21086)）
- **用途**：將 HTTP 503 加入 LLM provider errors 的 failover-eligible 清單。
- **解決問題**：避免 503 時不觸發 failover。
- **影響**：提升 provider failover 覆蓋率。

### ⭐⭐ Agents/Failover：修復 non-default override runs 的 fallback 行為（[#18820](https://github.com/openclaw/openclaw/pull/18820)）
- **用途**：non-default override runs 直接 fallback-to-configured-primary（跳過 configured fallback chain），normalize default-model detection。
- **解決問題**：修復 override/auth error paths 的 fallback 行為。
- **影響**：提升 failover 邏輯正確性。

### ⭐ Discord：修復 model picker 缺 provider 時的返回導航（[#21458](https://github.com/openclaw/openclaw/pull/21458)）
- **用途**：恢復 picker back navigation 並補足流程文件。
- **解決問題**：避免使用者在缺 provider 時卡住。
- **影響**：提升 Discord 端設定流暢度。

### ⭐ Discord/Streaming：修復 `replyToMode: first` 只套用於首個 chunk（[#20726](https://github.com/openclaw/openclaw/issues/20726)）
- **用途**：避免 block-streamed replies spam mention pings。
- **解決問題**：修復每個 chunk 都觸發 mention。
- **影響**：提升 Discord streaming 體驗。

### ⭐ Discord/Components：修復 DM channel 的 component sessions
- **用途**：將 DM channel targets 映射回 user-scoped component sessions。
- **解決問題**：修復 button/select interactions 脫離 main DM session。
- **影響**：提升 Discord DM 互動穩定性。

### ⭐ Discord/Allowlist：lazy-load guild lists（[#20208](https://github.com/openclaw/openclaw/pull/20208)）
- **用途**：解析 Discord user allowlists 時 lazy-load guild lists。
- **解決問題**：修復 guild fetch 失敗時 ID-only entries 無法 resolve。
- **影響**：提升 allowlist 可靠度。

### ⭐ Discord/Gateway：處理 close code 4014（missing privileged gateway intents）
- **用途**：gracefully 處理 4014 close code。
- **解決問題**：避免 gateway crash。
- **影響**：提升 Discord gateway 穩定性。

### ⭐ Discord：ingest inbound stickers as media
- **用途**：讓 sticker-only messages 與 forwarded stickers 對 agents 可見。
- **解決問題**：修復 sticker 訊息被忽略。
- **影響**：提升 Discord 訊息完整性。

### ⭐ Auto-reply/WebChat：避免 runtime channel label 誤預設（[#21534](https://github.com/openclaw/openclaw/pull/21534)）
- **用途**：避免 webchat session 的 channel label 被預設成無關 provider。
- **解決問題**：避免 channel-specific 格式化建議錯置。
- **影響**：提升 webchat 使用體驗。

### ⭐ Auto-reply/Runner：修復 `onAgentRunStart` 時機（[#21165](https://github.com/openclaw/openclaw/pull/21165)）
- **用途**：僅在 agent lifecycle 或 tool activity 開始後（且每次 run 僅一次）emit `onAgentRunStart`。
- **解決問題**：修復 fallback preflight errors 錯誤標記 runs 為 started。
- **影響**：提升 run lifecycle 準確度。

### ⭐ Status：在 session summaries 中包含 `cacheRead`/`cacheWrite`
- **用途**：讓 compact `/status` output 一致顯示 cache hit percentages。
- **解決問題**：修復 cache 統計遺漏。
- **影響**：提升可觀測性。

### ⭐ Heartbeat/Cron：恢復 interval heartbeat 行為
- **用途**：缺少 `HEARTBEAT.md` 不再抑制 runs（僅 effectively empty files 跳過）。
- **解決問題**：修復 heartbeat 被意外抑制。
- **影響**：提升排程可靠度。

### ⭐ WhatsApp/Cron/Heartbeat：強制 allowlisted routing
- **用途**：合併 pairing-store + configured `allowFrom` recipients，選擇 authorized recipients，防止 heartbeat fan-out 至 unauthorized chats。
- **解決問題**：修復 heartbeat 發送至非授權 chats。
- **影響**：提升 WhatsApp 排程安全。

### ⭐ Heartbeat/Active hours：限制 `24` sentinel 解析為 `24:00`（[#21410](https://github.com/openclaw/openclaw/pull/21410)）
- **用途**：時間驗證時拒絕如 `24:30` 的無效值。
- **解決問題**：避免不合法設定造成行為不可預期。
- **影響**：提升設定驗證嚴謹度。

### ⭐ Heartbeat：同 start/end 視為 zero-width window（[#21408](https://github.com/openclaw/openclaw/pull/21408)）
- **用途**：將 `activeHours` start==end 視為永遠不在 window 內。
- **解決問題**：避免被誤判為 always-active。
- **影響**：排程行為更符合直覺。

### ⭐ CLI/Pairing：pairing list/approve 預設採用唯一可用 channel（[#21527](https://github.com/openclaw/openclaw/issues/21527)）
- **用途**：省略 channel 參數時自動選用唯一 channel。
- **解決問題**：避免 TUI-only 環境在 `pairing required` 時需猜參數。
- **影響**：提升新裝/故障復原體驗。

### ⭐ TUI/Pairing：提供 pairing-required 復原指引（[#21841](https://github.com/openclaw/openclaw/issues/21841)）
- **用途**：gateway disconnect 回 `pairing required` 時顯示明確修復步驟。
- **解決問題**：避免使用者不知如何解除阻塞。
- **影響**：提升故障自救能力。

### ⭐ TUI/Input：抑制重複 backspace 事件（[#19318](https://github.com/openclaw/openclaw/issues/19318)）
- **用途**：在同 burst window 內抑制 duplicate backspace。
- **解決問題**：修復 SSH composer 每按一次 backspace 可能刪兩字。
- **影響**：提升終端互動穩定性。

### ⭐ TUI/Heartbeat：抑制 heartbeat ACK/prompt noise（[#20228](https://github.com/openclaw/openclaw/issues/20228)）
- **用途**：`showOk` disabled 時抑制 chat streaming 中的 heartbeat ACK/prompt noise，保留 non-ACK heartbeat alerts。
- **解決問題**：減少 chat 中的雜訊。
- **影響**：提升 TUI 閱讀體驗。

### ⭐ Telegram/Streaming：多項修復
- 即使 dispatch throws 也清理 draft previews（[#19041](https://github.com/openclaw/openclaw/pull/19041)）
- 分離 reasoning/answer draft preview lanes，忽略 code snippets 中的 `<think>` tags（[#20774](https://github.com/openclaw/openclaw/pull/20774)）
- 恢復 30-char first-preview debounce，scope `NO_REPLY` prefix suppression（[#22613](https://github.com/openclaw/openclaw/pull/22613)）
- 修復 status reactions stall timers 與 ack-reaction scope（含 fallback 至 unrestricted variant，[#22380](https://github.com/openclaw/openclaw/pull/22380)）
- **影響**：大幅提升 Telegram streaming 穩定性。

### ⭐ Gateway/Hooks：修復 hook-transform cache keys（[#13855](https://github.com/openclaw/openclaw/pull/13855)）
- **用途**：在 cache keys 中包含 transform export name。
- **解決問題**：修復同 module 的不同 exports 重用錯誤的 cached transform function。
- **影響**：提升 webhook 正確性。

### ⭐ Gateway/Control UI：修復 missing static-asset paths 回傳 404（[#12060](https://github.com/openclaw/openclaw/pull/12060)）
- **用途**：對 missing static-asset paths 回傳 404 而非 SPA fallback HTML。
- **解決問題**：修復 asset 404 被 SPA fallback 掩蓋。
- **影響**：提升除錯效率。

### ⭐ CLI/Config：新增 canonical `--strict-json` parsing（[#21332](https://github.com/openclaw/openclaw/pull/21332)）
- **用途**：為 `config set` 新增 `--strict-json`，保留 `--json` 為 legacy alias。
- **解決問題**：減少 help/behavior drift。
- **影響**：提升 CLI 一致性。

### ⭐ CLI：修復 `openclaw -v` 為 root-only version alias（[#21303](https://github.com/openclaw/openclaw/pull/21303)）
- **用途**：避免 subcommand `-v, --verbose` flags 被全域攔截。
- **解決問題**：修復 ACP/hooks/skills 的 verbose flag 失效。
- **影響**：提升 CLI 正確性。

### ⭐ CLI/Onboarding：修復 Anthropic-compatible custom provider verification（[#21336](https://github.com/openclaw/openclaw/pull/21336)）
- **用途**：normalize base URLs 避免 duplicate `/v1` paths。
- **解決問題**：修復 setup checks 失敗。
- **影響**：提升 onboarding 穩定性。

### ⭐ Memory：修復 `memory_get`/QMD 讀取未建立檔案時的 ENOENT（[#20680](https://github.com/openclaw/openclaw/pull/20680)）
- **用途**：回傳 empty snippets，強化 memory indexing/session helpers 對 ENOENT races 的處理。
- **解決問題**：修復 missing Markdown 導致 tools crash。
- **影響**：提升 memory 工具穩定性。

### ⭐ Hooks/Session memory：修復 `/new` 與 `/reset` 的 session-memory persistence（[#21382](https://github.com/openclaw/openclaw/issues/21382)）
- **用途**：在 `/new` 與 `/reset` 時都觸發 bundled `session-memory` persistence。
- **解決問題**：修復 reset flows 跳過 markdown transcript capture。
- **影響**：提升 session memory 完整性。

### ⭐ Tools/web_search：處理 xAI Responses API payloads（[#20508](https://github.com/openclaw/openclaw/pull/20508)）
- **用途**：處理 top-level `output_text` blocks（無 `message` wrapper）。
- **解決問題**：修復 Grok web_search 回傳 `No response`。
- **影響**：提升 web_search 相容性。

### ⭐ Agents/System Prompt：標記 allowlisted senders 為 authorized senders
- **用途**：避免暗示 ownership。
- **解決問題**：修復 system prompt 中的語義不精確。
- **影響**：提升 prompt 準確度。

### ⭐ Agents/Tool display：修復 exec cwd suffix inference（[#21925](https://github.com/openclaw/openclaw/pull/21925)）
- **用途**：修復 `pushd ... && popd ... && <command>` 的 stale `(in <dir>)` context。
- **解決問題**：修復 summaries 中的錯誤目錄顯示。
- **影響**：提升 tool 顯示準確度。

### ⭐ Docker/Build：修復 `TS2769` 與 Playwright Chromium 安裝（[#22558](https://github.com/openclaw/openclaw/pull/22558)、[#22585](https://github.com/openclaw/openclaw/pull/22585)）
- **用途**：在 `CommandsSchema` 加入 `ownerDisplay` object-level defaults；安裝 Playwright Chromium 至正確路徑並設定 ownership。
- **解決問題**：修復 Docker `pnpm build` 失敗與 browser binaries 不可用。
- **影響**：提升 Docker 建置穩定性。

### ⭐ Docker：pin base images to SHA256 digests（[#7734](https://github.com/openclaw/openclaw/pull/7734)）
- **用途**：防止 mutable tag drift。
- **解決問題**：確保建置可重現性。
- **影響**：提升 Docker 建置安全與一致性。

### ⭐ Docker：以 `node` user 執行 build steps
- **用途**：使用 `COPY --chown` 避免 recursive ownership changes。
- **解決問題**：減少 image size 與 layer churn。
- **影響**：提升 Docker image 效率。

### ⭐ Signal/Outbound：保留 Base64 group IDs 大小寫（[#5578](https://github.com/openclaw/openclaw/issues/5578)）
- **用途**：outbound target normalization 時保留 case。
- **解決問題**：修復 group IDs 含大寫字元時 cross-context routing 失敗。
- **影響**：提升 Signal channel 穩定性。

### ⭐ Anthropic/Agents：保留 pi-ai default OAuth beta headers（[#19789](https://github.com/openclaw/openclaw/pull/19789)，fixes [#19769](https://github.com/openclaw/openclaw/issues/19769)）
- **用途**：當 `context1m` 注入 `anthropic-beta` 時保留 required pi-ai default OAuth beta headers。
- **解決問題**：修復 `sk-ant-oat-*` tokens 的 401 auth failures。
- **影響**：提升 Anthropic provider 穩定性。

### ⭐ iOS/Gateway/Tools：多項修復（[#22120](https://github.com/openclaw/openclaw/pull/22120)）
- **用途**：偏好 uniquely connected node matches、surface actionable `nodes invoke` pairing-required guidance、refresh active iOS gateway registration after capability changes。
- **解決問題**：修復 duplicate display names 與 capability updates 不即時。
- **影響**：提升 iOS gateway 互動穩定性。

### ⭐ iOS/Watch：新增 watch approval/reject controls 與 quick-reply actions（[#21996](https://github.com/openclaw/openclaw/pull/21996)）
- **用途**：支援 watch-originated approvals 與 responses 直接從 notification flows 發送。
- **解決問題**：提升 watch 端操作能力。
- **影響**：強化穿戴裝置互動。

### ⭐ iOS/Watch：更新 app icon assets（[#21997](https://github.com/openclaw/openclaw/pull/21997)）
- **用途**：以 lobster icon set 更新 iOS 與 watch app icon。
- **解決問題**：保持 phone/watch branding 一致。
- **影響**：提升品牌一致性。

### ⭐ macOS/Build：修復 auto-update（[#19750](https://github.com/openclaw/openclaw/pull/19750)）
- **用途**：預設 release packaging 使用 `BUNDLE_ID=ai.openclaw.mac`，保留 Sparkle feed URL。
- **解決問題**：修復 auto-update 因 empty appcast feed 失敗。
- **影響**：提升 macOS 更新體驗。

### ⭐ Config/Agents：expose Pi compaction tuning values（[#21568](https://github.com/openclaw/openclaw/pull/21568)）
- **用途**：在 config schema/types 中暴露 `agents.defaults.compaction.reserveTokens` 與 `keepRecentTokens`。
- **解決問題**：讓使用者可調整 compaction 參數。
- **影響**：提升 compaction 可配置性。

### ⭐ Config/Memory：恢復 hybrid `mmr` 與 `temporalDecay` 的 schema metadata（[#18786](https://github.com/openclaw/openclaw/pull/18786)）
- **用途**：修復 configuration surfaces 顯示正確的 names 與 guidance。
- **解決問題**：修復 schema help/label metadata 遺失。
- **影響**：提升設定體驗。

### ⭐ Dependencies/Agents：bump embedded Pi SDK 至 0.54.0（[#21578](https://github.com/openclaw/openclaw/pull/21578)）
- **用途**：更新 `@mariozechner/pi-agent-core` 等 packages。
- **解決問題**：納入最新修復與改進。
- **影響**：提升 Pi agent 穩定性。

### ⭐ Skills/SonosCLI：新增 macOS troubleshooting guidance（[#21316](https://github.com/openclaw/openclaw/pull/21316)）
- **用途**：針對 `sonos discover` 在 macOS direct mode 的失敗提供排查指引。
- **解決問題**：降低 macOS 使用者的排查成本。
- **影響**：提升文件完整性。

---

## 總結

| 類別 | 3 顆星 | 2 顆星 | 1 顆星 | 摘要 |
|------|--------|--------|--------|------|
| 功能更新 | 3 | 12 | 6 | 擴充 providers（Volcano Engine/BytePlus、Gemini 3.1）、Discord voice/streaming/reactions、iOS/Watch 穩定性、per-channel model overrides、dependencies 清理 |
| 安全性 | 17 | 11 | 3 | Shell injection/allowlist bypass 防護、browser 導航/symlink 安全、prototype-chain/prompt injection 防護、sandbox 加固、傳輸安全強化 |
| 錯誤修復 | 5 | 18 | 30+ | Memory/QMD 大量修復、Pi runner retry cap、compaction/subagent chain 修復、Telegram/Discord/Slack streaming、Gateway pairing/auth、Docker build |
| **總計** | 25 | 41 | 39+ | 105+ 項更新 |

**發佈日期**: 2026-02-21
**版本**: 2026.2.21
**狀態**: Production Ready
**GitHub Release**: https://github.com/openclaw/openclaw/releases/tag/v2026.2.21
**npm hotfix**: `openclaw@2026.2.21-1`
