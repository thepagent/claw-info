# iOS æ¶æ§‹æ–‡ä»¶

## TL;DR

- iOS app åŒæ™‚æ‰®æ¼”**å®¢æˆ¶ç«¯**èˆ‡ **Gateway**ï¼Œå¯å…§å»ºæˆ–é€£æ¥é ç«¯ gateway
- Apple Watch é€é WatchConnectivity èˆ‡ iOS é€šè¨Šï¼Œç„¡æ³•ç›´é€£é ç«¯ gateway
- æä¾› `watch.status` èˆ‡ `watch.notify` å…©å€‹ bridge å‘½ä»¤
- æ”¯æ´å…©ç¨®å‚³è¼¸æ¨¡å¼ï¼š`sendMessage`ï¼ˆå³æ™‚ï¼‰èˆ‡ `transferUserInfo`ï¼ˆæ’éšŠï¼‰
- Gateway ä½¿ç”¨èˆ‡æ¡Œé¢ç‰ˆç›¸åŒçš„ WebSocket protocol èˆ‡ capability ç³»çµ±
- é©ç”¨æ–¼è¡Œå‹•è£ç½®æœ¬åœ°èƒ½åŠ›ï¼ˆç›¸æ©Ÿã€ä½ç½®ã€é€šçŸ¥ï¼‰èˆ‡è·¨è£ç½® agent æœƒè©±

## ä½¿ç”¨æƒ…å¢ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       iOS Gateway ä½¿ç”¨å ´æ™¯æ±ºç­–                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å ´æ™¯ 1ï¼šç¨ç«‹è¡Œå‹•ä½¿ç”¨                                                        â”‚
â”‚    âœ“ ä½¿ç”¨å…§å»º Gateway                                                       â”‚
â”‚    â€¢ ç„¡éœ€èˆ‡å…¶ä»–è£ç½®å…±äº«æœƒè©±                                                  â”‚
â”‚    â€¢ éœ€è¦ä½å»¶é²å­˜å–æœ¬åœ°èƒ½åŠ›ï¼ˆç›¸æ©Ÿã€ä½ç½®ï¼‰                                     â”‚
â”‚    â€¢ ç„¡ç©©å®šç¶²è·¯é€£ç·šè‡³é ç«¯ gateway                                            â”‚
â”‚                                                                             â”‚
â”‚  å ´æ™¯ 2ï¼šè·¨è£ç½®å”ä½œ                                                          â”‚
â”‚    âœ“ ä½¿ç”¨é ç«¯ Gateway                                                       â”‚
â”‚    â€¢ éœ€è¦åœ¨ Mac/iOS/Android é–“å…±äº« agent æœƒè©±                               â”‚
â”‚    â€¢ é›†ä¸­ç®¡ç† gateway é…ç½®èˆ‡ agent ç‹€æ…‹                                      â”‚
â”‚    â€¢ é€é Tailscale/VPN å®‰å…¨å­˜å–å®¶ä¸­æˆ–è¾¦å…¬å®¤ gateway                         â”‚
â”‚                                                                             â”‚
â”‚  å ´æ™¯ 3ï¼šApple Watch é€šçŸ¥                                                   â”‚
â”‚    âœ“ ä½¿ç”¨ watch.notify å‘½ä»¤                                                 â”‚
â”‚    â€¢ æœƒè­°æé†’ã€ä»»å‹™æé†’ç­‰æ™‚æ•ˆæ€§é€šçŸ¥                                          â”‚
â”‚    â€¢ å¿«é€Ÿå¯ç¥è¦‹çš„ç‹€æ…‹æ›´æ–°                                                    â”‚
â”‚    â€¢ ç·Šæ€¥è­¦å ±ï¼ˆå¸¶è§¸è¦ºå›é¥‹ï¼‰                                                  â”‚
â”‚                                                                             â”‚
â”‚  å ´æ™¯ 4ï¼šé›¢ç·šå„ªå…ˆ                                                            â”‚
â”‚    âœ“ ä½¿ç”¨å…§å»º Gateway + transferUserInfo                                    â”‚
â”‚    â€¢ ç¶²è·¯ä¸ç©©å®šç’°å¢ƒ                                                          â”‚
â”‚    â€¢ è¨Šæ¯æ’éšŠç­‰å¾… watch å¯é”                                                 â”‚
â”‚    â€¢ ä¿è­‰å‚³é€ï¼ˆéå³æ™‚ï¼‰                                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¦‚è¿°

OpenClaw iOS app æ‰®æ¼”é›™é‡è§’è‰²ï¼š
1. **å®¢æˆ¶ç«¯** - èˆ‡ AI agent äº’å‹•çš„ä½¿ç”¨è€…ä»‹é¢
2. **Gateway** - è£ç½®èƒ½åŠ›èˆ‡ agent å¾Œç«¯ä¹‹é–“çš„æ©‹æ¨‘

## iOS Gateway æ¶æ§‹

### å…§å»º vs é ç«¯ Gateway

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Gateway æ¨¡å¼å°ç…§è¡¨                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ç‰¹æ€§              â”‚  å…§å»º Gateway        â”‚  é ç«¯ Gateway                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  éƒ¨ç½²ä½ç½®          â”‚  iOS app å…§          â”‚  Mac/ä¼ºæœå™¨                     â”‚
â”‚  ç¶²è·¯éœ€æ±‚          â”‚  åƒ…éœ€é€£æ¥ agent å¾Œç«¯  â”‚  éœ€é€£æ¥è‡³é ç«¯ gateway           â”‚
â”‚  å»¶é²              â”‚  ä½ï¼ˆæœ¬åœ°è™•ç†ï¼‰       â”‚  ä¸­ï¼ˆç¶²è·¯å¾€è¿”ï¼‰                 â”‚
â”‚  æœƒè©±å…±äº«          â”‚  ä¸æ”¯æ´              â”‚  æ”¯æ´è·¨è£ç½®                     â”‚
â”‚  é…ç½®ç®¡ç†          â”‚  åˆ†æ•£æ–¼å„è£ç½®         â”‚  é›†ä¸­ç®¡ç†                       â”‚
â”‚  é©ç”¨å ´æ™¯          â”‚  ç¨ç«‹è¡Œå‹•ä½¿ç”¨         â”‚  å¤šè£ç½®å”ä½œ                     â”‚
â”‚  å®‰å…¨æ€§            â”‚  æœ¬åœ°éš”é›¢            â”‚  éœ€ VPN/Tailscale               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…§å»º Gatewayï¼ˆé è¨­ï¼‰**
- Gateway é‹è¡Œæ–¼ iOS app ç¨‹åºå…§
- ç›´æ¥é€£æ¥è‡³ agent å¾Œç«¯
- æœ¬åœ°èƒ½åŠ›å»¶é²è¼ƒä½
- é©åˆç¨ç«‹è¡Œå‹•ä½¿ç”¨

**é ç«¯ Gatewayï¼ˆé€²éšï¼‰**
- iOS app é€£æ¥è‡³å¤–éƒ¨ gatewayï¼ˆMac/ä¼ºæœå™¨ï¼‰
- é›†ä¸­å¼ gateway ç®¡ç†
- è·¨è£ç½®å…±äº« agent æœƒè©±
- éœ€è¦ç¶²è·¯é€£ç·š

### Gateway æ¨¡å¼æ¯”è¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              OpenClaw æ¶æ§‹ï¼šæœ¬åœ° vs é ç«¯ Gateway                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ–¹æ¡ˆä¸€ï¼šæœ¬åœ° Gatewayï¼ˆiOS å…§å»ºï¼‰                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  Watch   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚       â”‚ WatchConnectivity                                       â”‚
â”‚       â†“                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚     iOS App          â”‚                                       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                       â”‚
â”‚  â”‚  â”‚ Built-in       â”‚  â”‚                                       â”‚
â”‚  â”‚  â”‚ Gateway        â”‚â”€â”€â”¼â”€â”€â†’ Agent (Cloud)                      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  æ–¹æ¡ˆäºŒï¼šé ç«¯ Gatewayï¼ˆMac/Serverï¼‰                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚  Watch   â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚       â”‚ WatchConnectivity                                       â”‚
â”‚       â†“                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      WebSocket                        â”‚
â”‚  â”‚     iOS App          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  (Thin Client)       â”‚                 â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â†“                     â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                                      â”‚  Remote Gateway  â”‚       â”‚
â”‚                                      â”‚  (Mac/Server)    â”‚â”€â”€â”€â†’ Agent
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é…ç½®

**å…§å»º Gateway**
- ç„¡éœ€é…ç½®
- éš¨ app è‡ªå‹•å•Ÿå‹•

**é ç«¯ Gateway**
- æ–¼ app è¨­å®šä¸­è¨­ç½® gateway URL
- å®Œæˆé…å°æµç¨‹ä»¥é€²è¡Œèº«ä»½é©—è­‰
- æ”¯æ´ Tailscale/VPN ä»¥é€²è¡Œå®‰å…¨é ç«¯å­˜å–

## Apple Watch æ•´åˆ

### æ¦‚è¿°

Apple Watch ä¼´ä¾¶ app é€é WatchConnectivity æ¡†æ¶å¾ iOS æ¥æ”¶é€šçŸ¥ã€‚æ–¼ [PR #20054](https://github.com/openclaw/openclaw/pull/20054) å¼•å…¥ã€‚

### æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           iOS â†” Apple Watch é€šè¨Šæ¶æ§‹                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  iPhone                        Apple Watch             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ iOS App          â”‚          â”‚ watchOS App      â”‚    â”‚
â”‚  â”‚                  â”‚          â”‚                  â”‚    â”‚
â”‚  â”‚ Gateway          â”‚          â”‚ WatchInboxView   â”‚    â”‚
â”‚  â”‚   â†“              â”‚          â”‚   â†‘              â”‚    â”‚
â”‚  â”‚ watch.status â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Status        â”‚    â”‚
â”‚  â”‚ watch.notify â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Notification  â”‚    â”‚
â”‚  â”‚   â†“              â”‚          â”‚   â†“              â”‚    â”‚
â”‚  â”‚ WatchMessaging   â”‚  WCSession  â”‚ Connectivity    â”‚    â”‚
â”‚  â”‚ Service          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Receiver        â”‚    â”‚
â”‚  â”‚                  â”‚          â”‚   â†“              â”‚    â”‚
â”‚  â”‚                  â”‚          â”‚ WatchInboxStore  â”‚    â”‚
â”‚  â”‚                  â”‚          â”‚   â†“              â”‚    â”‚
â”‚  â”‚                  â”‚          â”‚ Local Notify ğŸ””  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  Transport:                                             â”‚
â”‚  â€¢ sendMessage (å³æ™‚ï¼Œæ‰‹éŒ¶å¯é”æ™‚)                        â”‚
â”‚  â€¢ transferUserInfo (æ’éšŠï¼Œæ‰‹éŒ¶ä¸å¯é”æ™‚)                 â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bridge å‘½ä»¤

#### `watch.status`

æŸ¥è©¢ Apple Watch é€£æ¥ç‹€æ…‹ã€‚

**è«‹æ±‚ï¼š**
```typescript
await callGateway({
  command: 'watch.status'
})
```

**å›æ‡‰ï¼š**
```typescript
{
  supported: boolean,        // WatchConnectivity å¯ç”¨
  paired: boolean,           // æ‰‹éŒ¶å·²é…å°
  appInstalled: boolean,     // OpenClaw watch app å·²å®‰è£
  reachable: boolean,        // æ‰‹éŒ¶ç›®å‰å¯é”
  activationState: string    // "activated" | "inactive" | "notActivated"
}
```

#### `watch.notify`

ç™¼é€é€šçŸ¥è‡³ Apple Watchã€‚

**è«‹æ±‚ï¼š**
```typescript
await callGateway({
  command: 'watch.notify',
  params: {
    title: string,
    body: string,
    priority?: 'active' | 'passive' | 'timeSensitive'
  }
})
```

**å›æ‡‰ï¼š**
```typescript
{
  deliveredImmediately: boolean,  // é€é sendMessage ç™¼é€
  queuedForDelivery: boolean,     // é€é transferUserInfo æ’éšŠ
  transport: string               // "sendMessage" | "transferUserInfo"
}
```

### å‚³è¼¸æ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Watch å‚³è¼¸æ¨¡å¼å°ç…§è¡¨                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ç‰¹æ€§              â”‚  sendMessage         â”‚  transferUserInfo               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å‚³é€æ™‚æ©Ÿ          â”‚  watch å¯é”æ™‚         â”‚  watch ä¸å¯é”æ™‚                 â”‚
â”‚  å‚³é€æ–¹å¼          â”‚  å³æ™‚æ¨é€            â”‚  æ’éšŠç­‰å€™                       â”‚
â”‚  éœ€è¦æ¢ä»¶          â”‚  æ´»èºé€£æ¥            â”‚  ç„¡éœ€é€£æ¥                       â”‚
â”‚  å›è¦†è™•ç†å™¨        â”‚  æ”¯æ´                â”‚  ä¸æ”¯æ´                         â”‚
â”‚  ä¿è­‰å‚³é€          â”‚  å¦ï¼ˆå¯èƒ½å¤±æ•—ï¼‰       â”‚  æ˜¯ï¼ˆä½‡åˆ—ä¿è­‰ï¼‰                 â”‚
â”‚  å›é€€æ©Ÿåˆ¶          â”‚  å¤±æ•—æ™‚è‡ªå‹•å›é€€è‡³     â”‚  N/A                           â”‚
â”‚                   â”‚  transferUserInfo    â”‚                                â”‚
â”‚  é©ç”¨å ´æ™¯          â”‚  å³æ™‚é€šçŸ¥            â”‚  é›¢ç·šè¨Šæ¯                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**sendMessageï¼ˆå³æ™‚ï¼‰**
- æ‰‹éŒ¶å¯é”æ™‚ä½¿ç”¨
- éœ€è¦æ´»èºé€£æ¥
- ç«‹å³å‚³é€ä¸¦å¸¶æœ‰å›è¦†è™•ç†å™¨
- å¤±æ•—æ™‚å›é€€è‡³ transferUserInfo

**transferUserInfoï¼ˆæ’éšŠï¼‰**
- æ‰‹éŒ¶ä¸å¯é”æ™‚ä½¿ç”¨
- æ’éšŠç­‰å¾…ç¨å¾Œå‚³é€
- æ‰‹éŒ¶å¯ç”¨æ™‚å‚³é€
- ä¿è­‰å‚³é€

### é—œéµå…ƒä»¶

#### iOS ç«¯

#### iOS ç«¯

**[GatewayConnectionController.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/Sources/Gateway/GatewayConnectionController.swift)**
- ç®¡ç† gateway ç”Ÿå‘½é€±æœŸ
- è‹¥æ”¯æ´å‰‡è¨»å†Š `watch` capability
- æ–¼ permissions ä¸­æš´éœ² watch ç‹€æ…‹

**[WatchMessagingService.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/Sources/Services/WatchMessagingService.swift)**
- å¯¦ä½œ `WatchMessagingServicing` protocol
- ç®¡ç† `WCSession` delegate
- è™•ç†è¨Šæ¯ç™¼é€èˆ‡å›é€€é‚è¼¯
- æä¾›ç‹€æ…‹å¿«ç…§

**[NodeAppModel.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/Sources/Model/NodeAppModel.swift)**
- è·¯ç”± `watch.status` èˆ‡ `watch.notify` å‘½ä»¤
- é©—è­‰è¨Šæ¯å…§å®¹ï¼ˆæ‹’çµ•ç©ºç™½è¨Šæ¯ï¼‰
- å›å‚³é©ç•¶çš„éŒ¯èª¤ç¢¼

#### watchOS ç«¯

**[WatchConnectivityReceiver.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/WatchExtension/Sources/WatchConnectivityReceiver.swift)**
- æ¥æ”¶ä¾†è‡ª iPhone çš„è¨Šæ¯
- è§£æé€šçŸ¥ payload
- æ”¯æ´æ‰€æœ‰ WatchConnectivity å‚³è¼¸æ–¹æ³•

**[WatchInboxStore.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/WatchExtension/Sources/WatchInboxStore.swift)**
- æŒä¹…åŒ–è¨Šæ¯è‡³ UserDefaults
- é€é delivery key å»é‡è¤‡è¨Šæ¯
- é€é `UNUserNotificationCenter` ç™¼é€æœ¬åœ°é€šçŸ¥
- å¯è§€å¯Ÿçš„ç‹€æ…‹ä¾› UI æ›´æ–°

**[WatchInboxView.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/WatchExtension/Sources/WatchInboxView.swift)**
- é¡¯ç¤ºæœ€æ–°é€šçŸ¥
- é¡¯ç¤ºæ¨™é¡Œã€å…§å®¹èˆ‡æ™‚é–“æˆ³è¨˜
- åŸºæ–¼ SwiftUI çš„ä»‹é¢

### Capability è¨»å†Š

iOS æ–¼æ”¯æ´æ™‚è‡ªå‹•è¨»å†Š `watch` capabilityï¼š

### Capability è¨»å†Š

iOS æ–¼æ”¯æ´æ™‚è‡ªå‹•è¨»å†Š `watch` capabilityï¼š

```swift
// GatewayConnectionController.swift
if WatchMessagingService.isSupportedOnDevice() {
    caps.append(OpenClawCapability.watch.rawValue)
}
```

Gateway æ–¼è£ç½® permissions ä¸­æš´éœ² watch ç‹€æ…‹ï¼š

```typescript
{
  watchSupported: true,
  watchPaired: true,
  watchAppInstalled: true,
  watchReachable: true
}
```

### ä½¿ç”¨å ´æ™¯

- **æœƒè­°æé†’** - Agent ç™¼é€æ™‚æ•ˆæ€§é€šçŸ¥
- **ä»»å‹™æé†’** - é‡è¦å¾…è¾¦äº‹é …æ¨é€è‡³æ‰‹éŒ¶
- **ç‹€æ…‹æ›´æ–°** - å¿«é€Ÿå¯ç¥è¦‹çš„è³‡è¨Š
- **ç·Šæ€¥é€šçŸ¥** - å¸¶æœ‰è§¸è¦ºå›é¥‹çš„é—œéµè­¦å ±

### é™åˆ¶

- WatchConnectivity åƒ…æ”¯æ´ iPhone â†” Watch ç›´æ¥é€£æ¥
- Watch è¨Šæ¯ç„¡æ³•ç¹é iOS app åˆ°é”é ç«¯ gateway
- é€šçŸ¥éœ€è¦æ‰‹éŒ¶å·²é…å°ä¸” app å·²å®‰è£
- è¨Šæ¯å¤§å°é™åˆ¶é©ç”¨ï¼ˆä½¿ç”¨ç°¡æ½”å…§å®¹ï¼‰

## Bridge å‘½ä»¤èˆ‡ Capabilities

### Capability ç³»çµ±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    iOS Gateway Capabilities åˆ—è¡¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Capability    â”‚  èªªæ˜                    â”‚  éœ€è¦æ¬Šé™                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  screen        â”‚  è¢å¹•éŒ„è£½                â”‚  è¢å¹•éŒ„è£½æ¬Šé™                     â”‚
â”‚  camera        â”‚  ç›¸æ©Ÿæ‹ç…§/éŒ„å½±            â”‚  ç›¸æ©Ÿæ¬Šé™                        â”‚
â”‚  location      â”‚  ä½ç½®è¿½è¹¤                â”‚  ä½ç½®æ¬Šé™ï¼ˆalways/whenInUseï¼‰     â”‚
â”‚  watch         â”‚  Apple Watch é€šçŸ¥        â”‚  WatchConnectivity æ”¯æ´          â”‚
â”‚  photos        â”‚  ç›¸ç°¿å­˜å–                â”‚  ç›¸ç°¿æ¬Šé™                        â”‚
â”‚  contacts      â”‚  è¯çµ¡äººå­˜å–              â”‚  è¯çµ¡äººæ¬Šé™                      â”‚
â”‚  calendar      â”‚  è¡Œäº‹æ›†å­˜å–              â”‚  è¡Œäº‹æ›†æ¬Šé™                      â”‚
â”‚  reminders     â”‚  æé†’äº‹é …å­˜å–            â”‚  æé†’äº‹é …æ¬Šé™                    â”‚
â”‚  motion        â”‚  å‹•ä½œèˆ‡å¥èº«è³‡æ–™          â”‚  å‹•ä½œæ¬Šé™                        â”‚
â”‚  device        â”‚  è£ç½®è³‡è¨Š                â”‚  ç„¡éœ€æ¬Šé™                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

iOS gateway æ ¹æ“šè£ç½®æ”¯æ´è¨»å†Š capabilitiesï¼š

### Capability ç³»çµ±

iOS gateway æ ¹æ“šè£ç½®æ”¯æ´è¨»å†Š capabilitiesï¼š

```swift
var caps: [String] = []
caps.append("screen")
caps.append("camera")
if locationMode != .off { 
    caps.append("location") 
}
if WatchMessagingService.isSupportedOnDevice() {
    caps.append("watch")
}
caps.append("photos")
caps.append("contacts")
caps.append("calendar")
// ... æ›´å¤š capabilities
```

### å‘½ä»¤è¨»å†Š

å‘½ä»¤æŒ‰ capability è¨»å†Šï¼š

```swift
// Watch å‘½ä»¤
if caps.contains("watch") {
    commands.append("watch.status")
    commands.append("watch.notify")
}

// Photo å‘½ä»¤
if caps.contains("photos") {
    commands.append("photos.latest")
}

// Location å‘½ä»¤
if caps.contains("location") {
    commands.append("location.current")
    commands.append("location.track")
}
```

### Protocol ç›¸å®¹æ€§

iOS gateway ä½¿ç”¨èˆ‡æ¡Œé¢ gateway ç›¸åŒçš„ WebSocket protocolï¼š
- `BridgeInvokeRequest` / `BridgeInvokeResponse` è¨Šæ¯æ ¼å¼
- åŸºæ–¼ JSON çš„åƒæ•¸ç·¨ç¢¼
- ä¸€è‡´çš„éŒ¯èª¤ç¢¼ï¼ˆ`invalidRequest`ã€`unavailable` ç­‰ï¼‰
- é€£æ¥æ™‚çš„ capability å”å•†

## é…ç½®ç¯„ä¾‹

### é ç«¯ Gateway è¨­å®š

#### æ­¥é©Ÿ 1ï¼šæ–¼ Mac/ä¼ºæœå™¨å•Ÿå‹• Gateway

```bash
# å•Ÿå‹• gateway
openclaw gateway start

# æª¢æŸ¥ç‹€æ…‹
openclaw status

# é æœŸè¼¸å‡ºï¼ˆéƒ¨åˆ†ï¼‰ï¼š
# Gateway â”‚ local Â· ws://127.0.0.1:18789 (local loopback) Â· reachable 40ms
```

**å‰ç½®æ¢ä»¶ï¼š**
- å·²å®‰è£ OpenClaw CLI
- Gateway æœå‹™å·²å•Ÿå‹•
- é˜²ç«ç‰†å…è¨± 18789 portï¼ˆè‹¥éœ€é ç«¯å­˜å–ï¼‰

#### æ­¥é©Ÿ 2ï¼šæ–¼ iOS é…ç½® Gateway URL

```
iOS App æ“ä½œæ­¥é©Ÿï¼š
1. é–‹å•Ÿ OpenClaw app
2. é»é¸ã€Œè¨­å®šã€â†’ã€ŒGatewayã€
3. è¼¸å…¥ gateway URLï¼š
   - æœ¬åœ°ç¶²è·¯ï¼šws://192.168.1.100:18789
   - Tailscaleï¼šws://100.x.x.x:18789
4. é»é¸ã€Œé€£æ¥ã€
```

**æ³¨æ„äº‹é …ï¼š**
- URL å¿…é ˆä»¥ `ws://` æˆ– `wss://` é–‹é ­
- ç¢ºä¿ iOS è£ç½®å¯é€£æ¥è‡³è©² IP
- å»ºè­°ä½¿ç”¨ Tailscale ä»¥é¿å…æš´éœ²è‡³å…¬ç¶²

#### æ­¥é©Ÿ 3ï¼šå®Œæˆé…å°

```
é…å°æµç¨‹ï¼š
1. iOS ç™¼é€é…å°è«‹æ±‚
2. Mac/ä¼ºæœå™¨çµ‚ç«¯é¡¯ç¤º 6 ä½æ•¸é…å°ç¢¼
3. æ–¼ iOS è¼¸å…¥é…å°ç¢¼
4. é…å°æˆåŠŸï¼Œtoken å·²å„²å­˜
```

**é©—è­‰é€£æ¥ï¼š**
```bash
# æ–¼ Mac/ä¼ºæœå™¨æŸ¥çœ‹å·²é…å°è£ç½®
openclaw devices list

# é æœŸè¼¸å‡ºï¼š
# iPhone 15 Pro â”‚ paired â”‚ last seen: just now
```

### ä½¿ç”¨ Tailscale è¨­å®š

#### æ­¥é©Ÿ 1ï¼šå®‰è£ Tailscale

```bash
# macOS
brew install tailscale

# å•Ÿå‹• Tailscale
sudo tailscaled install-system-daemon
tailscale up
```

#### æ­¥é©Ÿ 2ï¼šå–å¾— Tailscale IP

```bash
# æŸ¥çœ‹æœ¬æ©Ÿ Tailscale IP
tailscale ip -4

# è¼¸å‡ºç¯„ä¾‹ï¼š
# 100.101.102.103
```

#### æ­¥é©Ÿ 3ï¼šæ–¼ iOS ä½¿ç”¨ Tailscale IP

```
1. iOS å®‰è£ Tailscale app ä¸¦ç™»å…¥åŒä¸€å¸³è™Ÿ
2. OpenClaw è¨­å®šä¸­è¼¸å…¥ï¼š
   ws://100.101.102.103:18789
3. å®Œæˆé…å°
```

**å„ªé»ï¼š**
- ç«¯å°ç«¯åŠ å¯†
- ç„¡éœ€é–‹æ”¾é˜²ç«ç‰†
- è·¨ç¶²è·¯å­˜å–ï¼ˆå®¶ä¸­/è¾¦å…¬å®¤/è¡Œå‹•ç¶²è·¯ï¼‰

### Apple Watch é€šçŸ¥ç¯„ä¾‹

#### ç¯„ä¾‹ 1ï¼šç°¡å–®æé†’

```bash
# ç™¼é€ç°¡å–®é€šçŸ¥
openclaw invoke watch.notify \
  --title "æœƒè­°æé†’" \
  --body "15 åˆ†é˜å¾Œèˆ‡ Peter é–‹æœƒ"
```

#### ç¯„ä¾‹ 2ï¼šæ™‚æ•ˆæ€§é€šçŸ¥

```bash
# ç™¼é€æ™‚æ•ˆæ€§é€šçŸ¥ï¼ˆæœƒçªç ´å‹¿æ“¾æ¨¡å¼ï¼‰
openclaw invoke watch.notify \
  --title "ç·Šæ€¥" \
  --body "ä¼ºæœå™¨ CPU ä½¿ç”¨ç‡è¶…é 90%" \
  --priority timeSensitive
```

#### ç¯„ä¾‹ 3ï¼šé€é Agent è‡ªå‹•ç™¼é€

```yaml
# cron é…ç½®ç¯„ä¾‹
schedule:
  kind: cron
  expr: "0 9 * * 1-5"  # å·¥ä½œæ—¥æ—©ä¸Š 9 é»
  tz: "Asia/Taipei"

payload:
  kind: agentTurn
  message: |
    æª¢æŸ¥ä»Šæ—¥è¡Œäº‹æ›†ï¼Œè‹¥æœ‰æœƒè­°å‰‡ç™¼é€ watch é€šçŸ¥æé†’ã€‚
    ä½¿ç”¨ watch.notify å‘½ä»¤ï¼Œæ¨™é¡Œç‚ºã€Œä»Šæ—¥æœƒè­°ã€ã€‚
```

### é…å°æ©Ÿåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é…å°æµç¨‹åœ–                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   iOS App                          Remote Gateway                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  1. è¼¸å…¥  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  2. æ”¶åˆ°  â”‚                            â”‚
â”‚   â”‚  Gateway â”‚  é…å°è«‹æ±‚ + è£ç½®è³‡è¨Š  â”‚  è«‹æ±‚    â”‚                            â”‚
â”‚   â”‚  URL     â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  3. ç”¢ç”Ÿ  â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  é…å°ç¢¼   â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  (6ä½æ•¸)  â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  4. é¡¯ç¤º  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  5. å›å‚³  â”‚                            â”‚
â”‚   â”‚  é…å°ç¢¼   â”‚                     â”‚  é…å°ç¢¼   â”‚                            â”‚
â”‚   â”‚  è¼¸å…¥æ¡†   â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  6. ä½¿ç”¨è€…â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  ç¢ºèªç¢¼   â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  7. é€å‡º  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  8. é©—è­‰  â”‚                            â”‚
â”‚   â”‚  ç¢ºèª    â”‚  é…å°ç¢¼              â”‚  é…å°ç¢¼   â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  9. ç”¢ç”Ÿ  â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  å…±äº«     â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚  Token   â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  10. å„²å­˜â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  11. å›å‚³â”‚                            â”‚
â”‚   â”‚  Token   â”‚  Token              â”‚  Token   â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â”‚  12. é€£æ¥â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  13. é©—è­‰â”‚                            â”‚
â”‚   â”‚  æˆåŠŸ    â”‚  ä½¿ç”¨ Token èªè­‰     â”‚  Token   â”‚                            â”‚
â”‚   â”‚          â”‚                     â”‚          â”‚                            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- iOS ç”¢ç”ŸåŒ…å«è£ç½®è³‡è¨Šçš„é…å°è«‹æ±‚
- Gateway é¡¯ç¤ºé…å°ç¢¼
- ä½¿ç”¨è€…æ–¼ iOS ä¸Šç¢ºèªé…å°ç¢¼
- å»ºç«‹å…±äº« token ä»¥é€²è¡Œèº«ä»½é©—è­‰
- Token æŒä¹…åŒ–ä»¥ä¾›æœªä¾†é€£æ¥

## æ¸¬è©¦

### å–®å…ƒæ¸¬è©¦

Watch æ•´åˆåŒ…å«å®Œæ•´æ¸¬è©¦ï¼š

**[NodeAppModelInvokeTests.swift](https://github.com/openclaw/openclaw/blob/main/apps/ios/Tests/NodeAppModelInvokeTests.swift)**
- `handleInvokeWatchStatusReturnsServiceSnapshot` - ç‹€æ…‹æŸ¥è©¢
- `handleInvokeWatchNotifyRoutesToWatchService` - é€šçŸ¥è·¯ç”±
- `handleInvokeWatchNotifyRejectsEmptyMessage` - è¼¸å…¥é©—è­‰
- `handleInvokeWatchNotifyReturnsUnavailableOnDeliveryFailure` - éŒ¯èª¤è™•ç†

### æ‰‹å‹•æ¸¬è©¦

1. **Watch ç‹€æ…‹ï¼š**
   ```bash
   # é€é gateway å‘½ä»¤
   openclaw invoke watch.status
   ```

2. **ç™¼é€é€šçŸ¥ï¼š**
   ```bash
   # é€é gateway å‘½ä»¤
   openclaw invoke watch.notify --title "æ¸¬è©¦" --body "ä½ å¥½ Watch"
   ```

3. **æ–¼ Watch ä¸Šé©—è­‰ï¼š**
   - æª¢æŸ¥ WatchInboxView æ›´æ–°
   - ç¢ºèªæœ¬åœ°é€šçŸ¥å‡ºç¾
   - é©—è­‰è§¸è¦ºå›é¥‹

## Troubleshooting

### ç—‡ç‹€ï¼šWatch é€šçŸ¥æœªé€é”

**å¯èƒ½åŸå› ï¼š**
1. Watch æœªé…å°æˆ– OpenClaw watch app æœªå®‰è£
2. Watch ä¸å¯é”ä¸” transferUserInfo ä½‡åˆ—å·²æ»¿
3. è¨Šæ¯å…§å®¹ç‚ºç©ºï¼ˆtitle èˆ‡ body çš†ç©ºç™½ï¼‰

**è™•ç†æ–¹å¼ï¼š**
```bash
# 1. æª¢æŸ¥ watch ç‹€æ…‹
openclaw invoke watch.status

# 2. ç¢ºèªè¼¸å‡º
# - paired: true
# - appInstalled: true
# - reachable: true (è‹¥ç‚º falseï¼Œè¨Šæ¯æœƒæ’éšŠ)

# 3. è‹¥ appInstalled ç‚º falseï¼Œæ–¼ iPhone ä¸Šé–‹å•Ÿ Watch app å®‰è£ OpenClaw
```

### ç—‡ç‹€ï¼šé ç«¯ Gateway é€£æ¥å¤±æ•—

**å¯èƒ½åŸå› ï¼š**
1. Gateway URL éŒ¯èª¤æˆ– gateway æœªå•Ÿå‹•
2. é˜²ç«ç‰†é˜»æ“‹ WebSocket é€£æ¥
3. é…å° token éæœŸæˆ–ç„¡æ•ˆ

**è™•ç†æ–¹å¼ï¼š**
```bash
# 1. æ–¼ Mac/ä¼ºæœå™¨ç¢ºèª gateway é‹è¡Œ
openclaw status
# ç¢ºèª Gateway æ¬„ä½é¡¯ç¤º "running"

# 2. æ¸¬è©¦é€£ç·š
curl -v ws://<gateway-ip>:18789

# 3. é‡æ–°é…å°
# iOS: è¨­å®š â†’ Gateway â†’ ç§»é™¤é…å° â†’ é‡æ–°é…å°
```

### ç—‡ç‹€ï¼šCapability æœªè¨»å†Š

**å¯èƒ½åŸå› ï¼š**
1. è£ç½®ä¸æ”¯æ´è©² capabilityï¼ˆå¦‚ WatchConnectivityï¼‰
2. æ¬Šé™æœªæˆäºˆï¼ˆå¦‚ä½ç½®ã€ç›¸æ©Ÿï¼‰
3. Gateway é€£æ¥æ™‚ capability æª¢æ¸¬å¤±æ•—

**è™•ç†æ–¹å¼ï¼š**
```bash
# 1. æª¢æŸ¥è£ç½® permissions
openclaw invoke device.info
# æŸ¥çœ‹ permissions æ¬„ä½

# 2. iOS è¨­å®šä¸­æˆäºˆå¿…è¦æ¬Šé™
# è¨­å®š â†’ OpenClaw â†’ æ¬Šé™

# 3. é‡æ–°é€£æ¥ gateway
# iOS: é—œé–‰ app â†’ é‡æ–°é–‹å•Ÿ
```

### ç—‡ç‹€ï¼šsendMessage å¤±æ•—å›é€€è‡³ transferUserInfo

**å¯èƒ½åŸå› ï¼š**
1. Watch æš«æ™‚ä¸å¯é”ï¼ˆè¢å¹•é—œé–‰ã€è—ç‰™æ–·ç·šï¼‰
2. WCSession å°šæœªå®Œå…¨å•Ÿå‹•

**è™•ç†æ–¹å¼ï¼š**
- é€™æ˜¯æ­£å¸¸è¡Œç‚ºï¼Œè¨Šæ¯æœƒæ’éšŠç­‰å¾… watch å¯é”æ™‚å‚³é€
- è‹¥éœ€ç«‹å³å‚³é€ï¼Œç¢ºä¿ watch è¢å¹•é–‹å•Ÿä¸” iPhone åœ¨é™„è¿‘
- æª¢æŸ¥ watch.status çš„ `reachable` æ¬„ä½

## å®‰å…¨æ³¨æ„äº‹é …

- **é…å° token**ï¼šå¦¥å–„ä¿ç®¡é…å° tokenï¼Œä¸è¦åˆ†äº«æˆ–æäº¤è‡³ç‰ˆæœ¬æ§åˆ¶
- **é ç«¯ Gateway**ï¼šä½¿ç”¨ Tailscale/VPN è€Œéç›´æ¥æš´éœ² gateway è‡³å…¬ç¶²
- **æ¬Šé™æœ€å°åŒ–**ï¼šåƒ…æˆäºˆ app å¿…è¦çš„è£ç½®æ¬Šé™
- **è¨Šæ¯å…§å®¹**ï¼šé¿å…åœ¨ watch é€šçŸ¥ä¸­åŒ…å«æ•æ„Ÿè³‡è¨Šï¼ˆé€šçŸ¥å¯èƒ½é¡¯ç¤ºæ–¼é–å®šç•«é¢ï¼‰

## ç‰ˆæœ¬ç›¸å®¹æ€§

- **iOS**: éœ€ iOS 15.0+
- **watchOS**: éœ€ watchOS 11.0+
- **Gateway Protocol**: èˆ‡ OpenClaw desktop gateway 2026.2.x+ ç›¸å®¹
- **WatchConnectivity**: ä½¿ç”¨ Apple åŸç”Ÿæ¡†æ¶ï¼Œå‘å¾Œç›¸å®¹

---

## å·²çŸ¥å•é¡Œï¼ˆOpen Issuesï¼‰

### ğŸ”´ Bugs

| Issue | æ¨™é¡Œ | èªªæ˜ |
|-------|------|------|
| [#14425](https://github.com/openclaw/openclaw/issues/14425) | iOS app crashes when receiving camera.snap command | iOS app æ”¶åˆ° camera.snap å‘½ä»¤æ™‚å´©æ½° |
| [#6767](https://github.com/openclaw/openclaw/issues/6767) | iOS chat broken â€” node role unauthorized | Node role æœªæˆæ¬Šå°è‡´è¨Šæ¯æ¶ˆå¤± |

### ğŸŸ¡ æ½›åœ¨æ”¹é€²ï¼ˆä¾†è‡ª PR #20054 Reviewï¼‰

| é …ç›® | èªªæ˜ | å„ªå…ˆç´š |
|------|------|--------|
| sendMessage æ¨‚è§€å›å ± | `deliveredImmediately: true` åœ¨å¯¦éš›å‚³é€å®Œæˆå‰å³å›å‚³ï¼ŒéåŒæ­¥å¤±æ•—æ™‚å‘¼å«æ–¹ä¸çŸ¥æƒ… | ä¸­ |
| å»é‡è¤‡é‚è¼¯èª¤åˆ¤ | ç›¸åŒå…§å®¹çš„ä¸åŒè¨Šæ¯å¯èƒ½è¢« `deliveryKey` èª¤åˆ¤ç‚ºé‡è¤‡ï¼ˆç•¶ messageID ç‚ºç©ºæ™‚ï¼‰ | ä½ |
| ç¾ä»£åŒ– watchOS æ¶æ§‹ | é·ç§»è‡³å–® target æ¶æ§‹ï¼ˆç§»é™¤ legacy `application.watchapp2` + `watchkit2-extension`ï¼‰ | ä½ |

### ğŸŸ¢ Feature Requests

| Issue | æ¨™é¡Œ | èªªæ˜ |
|-------|------|------|
| [#18843](https://github.com/openclaw/openclaw/issues/18843) | Add configurable timeout for node command execution | å¯é…ç½®çš„ node å‘½ä»¤åŸ·è¡Œè¶…æ™‚ |

**ç›¸é—œ PRï¼š**
- [#20054](https://github.com/openclaw/openclaw/pull/20054) - iOS Apple Watch companion MVPï¼ˆå·²åˆä½µï¼‰

---

## æ›´æ–°ç´€éŒ„

- **2026-02-19**ï¼šå»ºç«‹æ–‡ä»¶ï¼Œæ¶µè“‹ iOS gateway æ¶æ§‹èˆ‡ Apple Watch æ•´åˆ

---

## åƒè€ƒè³‡æ–™

- [PR #20054: iOS Apple Watch companion MVP](https://github.com/openclaw/openclaw/pull/20054)
- [OpenClaw ä¸»è¦å„²å­˜åº«](https://github.com/openclaw/openclaw)
- [Apple WatchConnectivity Framework](https://developer.apple.com/documentation/watchconnectivity)
